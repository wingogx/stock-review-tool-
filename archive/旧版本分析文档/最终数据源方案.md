# 最终数据源方案 - 完整总结

**项目**: 短线复盘工具
**测试日期**: 2025-12-07
**最终方案**: ✅ **Tushare (5000积分) + AKShare (免费)**

---

## 📊 三种方案对比

### 方案一：纯 AKShare（之前推荐）

| 优点 | 缺点 |
|------|------|
| ✅ 完全免费 | ⚠️ 机构席位需要解析营业部名称 |
| ✅ 数据完整（100%覆盖需求） | ⚠️ 基于爬虫，偶尔不稳定 |
| ✅ 无需注册 | ⚠️ 历史数据可能不如Tushare全 |
| ✅ 中文文档 | |

### 方案二：纯 Tushare（不推荐）

| 优点 | 缺点 |
|------|------|
| ✅ 数据权威稳定 | ❌ 概念板块需6000积分（你只有5000） |
| ✅ 历史数据全 | ❌ 涨停数据字段不够详细 |
| ✅ 机构席位直接分类 | ❌ 无炸板数据API |
| | ❌ 无市场活跃度API |

### 方案三：Tushare + AKShare（⭐ 最终推荐）

| 优点 | 缺点 |
|------|------|
| ✅ 充分利用5000积分优势 | ⚠️ 需要维护两套API |
| ✅ 龙虎榜机构席位自动分类 | ⚠️ 需要两个数据源的Token管理 |
| ✅ 数据质量最高（官方+爬虫） | |
| ✅ 功能最全（两者互补） | |
| ✅ 成本最优（500元/年） | |

---

## 🎯 最终推荐方案详解

### 数据源分工表

```
┌─────────────────────────────────────────────────────┐
│                  Tushare (5000积分)                  │
│  - 龙虎榜数据（top_list, top_inst）                   │
│  - 个股行情（daily, daily_basic）                     │
│  - 市场统计（daily_info）                            │
│  - 财务数据（income, balancesheet）[可选]             │
│                                                     │
│  优势：机构席位自动分类、数据稳定、历史完整             │
└─────────────────────────────────────────────────────┘
                          ↓ 互补 ↑
┌─────────────────────────────────────────────────────┐
│                   AKShare (免费)                     │
│  - 涨停池详细数据（stock_zt_pool_em）                 │
│  - 概念板块（stock_board_concept_name_ths）374个      │
│  - 市场活跃度（stock_market_activity_legu）独家       │
│  - 炸板数据（stock_zt_pool_zbgc_em）专有              │
│                                                     │
│  优势：字段详细、概念全面、独家数据、完全免费           │
└─────────────────────────────────────────────────────┘
```

---

## 📋 具体功能分配

### 1. 大盘指数区

| 数据 | 使用数据源 | 原因 |
|-----|-----------|------|
| 上证/深证/创业板 | **Tushare** 或 AKShare | 两者都可以，数据一致 |
| 涨跌幅、振幅 | **Tushare** | 官方数据更准确 |
| 成交额 | **Tushare** | 官方数据更准确 |

**API 示例：**
```python
# Tushare
df = pro.index_daily(ts_code='000001.SH', start_date='20251201', end_date='20251207')

# AKShare（备用）
df = ak.stock_zh_index_daily(symbol="sh000001")
```

---

### 2. 市场成交 & 情绪区

| 数据 | 使用数据源 | 原因 |
|-----|-----------|------|
| 全市场成交额 | **Tushare** | 官方权威数据 |
| 涨跌家数 | **Tushare** | 官方统计更准确 |
| 涨跌比 | **Tushare** | 基于官方数据计算 |
| 涨停家数 | **AKShare** | 字段更详细 |
| 连板分布 | **AKShare** | 直接提供连板数字段 |
| 炸板率 | **AKShare** | 专有炸板API |
| 市场活跃度 | **AKShare** | 同花顺独家数据 ⭐ |

**API 示例：**
```python
# Tushare: 市场统计
df_stats = pro.daily_info(trade_date='20251207')

# AKShare: 涨停池
zt_df = ak.stock_zt_pool_em(date="20251207")

# AKShare: 炸板数据
zbgc_df = ak.stock_zt_pool_zbgc_em(date="20251207")

# AKShare: 市场活跃度（独家）
activity_df = ak.stock_market_activity_legu()
```

---

### 3. 涨跌停个股详细列表

| 数据 | 使用数据源 | 原因 |
|-----|-----------|------|
| 涨停池列表 | **AKShare** | 字段最详细 ⭐ |
| 代码/名称 | **AKShare** | 完整 |
| 涨跌幅/收盘价 | **AKShare** | 完整 |
| 成交额/换手率 | **AKShare** | 完整 |
| 首次封板时间 | **AKShare** | Tushare无此字段 ⭐ |
| 最后封板时间 | **AKShare** | Tushare无此字段 ⭐ |
| 连板数 | **AKShare** | Tushare无此字段 ⭐ |
| 开板次数 | **AKShare** | Tushare无此字段 ⭐ |
| 所属概念 | **AKShare** | 完整 |

**为什么用 AKShare：**
- ✅ AKShare 的涨停池数据包含 **11个关键字段**
- ⚠️ Tushare 的 `stk_limit` 只有基础价格信息
- ⚠️ Tushare 的 `limit_step`（连板天梯）需要8000积分

**API 示例：**
```python
# AKShare 涨停池（推荐）
zt_df = ak.stock_zt_pool_em(date="20251207")
# 返回字段：代码, 名称, 涨跌幅, 最新价, 成交额, 换手率,
#          首次封板时间, 最后封板时间, 连板数, 开板次数, 所属行业

# Tushare 涨停数据（字段少）
df = pro.stk_limit(trade_date='20251207')
# 返回字段：仅包含 涨停价、跌停价 等基础价格信息
```

---

### 4. 龙虎榜数据

| 数据 | 使用数据源 | 原因 |
|-----|-----------|------|
| 龙虎榜每日明细 | **Tushare** | 官方数据更稳定 |
| 上榜原因 | **Tushare** | 完整 |
| 买入前5席位 | **Tushare** | 完整 |
| 卖出前5席位 | **Tushare** | 完整 |
| 营业部名称 | **Tushare** | 完整 |
| 买卖金额 | **Tushare** | 完整 |
| 机构席位统计 | **Tushare** | 直接分类 ⭐⭐⭐ |
| 游资席位排行 | **Tushare** + 自己统计 | Tushare提供基础数据 |

**为什么用 Tushare：**
- ✅ `top_inst` API（5000积分）**直接提供机构席位分类** ⭐⭐⭐
- ✅ AKShare 需要解析营业部名称中的"机构专用"关键词
- ✅ Tushare 数据稳定性更高

**API 示例：**
```python
# Tushare 龙虎榜（推荐）
df_list = pro.top_list(trade_date='20251207')
df_inst = pro.top_inst(trade_date='20251207')  # 5000积分优势 ⭐

# AKShare 龙虎榜（备用）
lhb_df = ak.stock_lhb_detail_em(start_date="20251207", end_date="20251207")
# 需要手动解析营业部名称识别机构席位
```

---

### 5. 热门概念/板块区

| 数据 | 使用数据源 | 原因 |
|-----|-----------|------|
| 概念板块列表 | **AKShare** | Tushare需6000积分 ⭐ |
| 概念涨跌幅 | **AKShare** | 完整 |
| 概念成分股 | **AKShare** | 完整 |
| 龙头股识别 | **AKShare** | 基于成分股计算 |
| 概念强度评分 | **AKShare** | 基于数据计算 |

**为什么用 AKShare：**
- ❌ Tushare 概念板块需要 **6000积分**（你只有5000）
- ✅ AKShare 提供 **374个概念**（vs Tushare的~300个）
- ✅ AKShare 包含同花顺数据，更全面
- ✅ AKShare 完全免费

**API 示例：**
```python
# AKShare 概念板块（推荐）
concepts_df = ak.stock_board_concept_name_ths()  # 374个概念
stocks_df = ak.stock_board_concept_cons_em(symbol="AI概念")

# Tushare 概念板块（你无法使用）
# df = pro.concept(src='ts')  # 需要6000积分 ❌
```

---

### 6. 自选/重点跟踪股票区

| 数据 | 使用数据源 | 原因 |
|-----|-----------|------|
| 个股历史行情 | **Tushare** | 官方数据更准确 |
| 当前价/涨跌幅 | **Tushare** | 官方数据 |
| 成交额/换手率 | **Tushare** | 官方数据 |
| 是否上龙虎榜 | **Tushare** | 龙虎榜用Tushare |
| 是否在热门概念 | **AKShare** | 概念用AKShare |
| 所属概念 | **AKShare** | 概念用AKShare |

**API 示例：**
```python
# Tushare 个股行情（推荐）
df = pro.daily(ts_code='000001.SZ', start_date='20251201', end_date='20251207')

# AKShare 个股行情（备用）
df = ak.stock_zh_a_hist(symbol="000001", period="daily", start_date="20251201", end_date="20251207")
```

---

## 💰 成本对比

| 方案 | 年度成本 | 数据质量 | 功能完整度 | 推荐度 |
|-----|---------|---------|-----------|--------|
| 纯 AKShare | **0元** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| 纯 Tushare（5000积分） | **500元** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ |
| **Tushare + AKShare** | **500元** | **⭐⭐⭐⭐⭐** | **⭐⭐⭐⭐⭐** | **⭐⭐⭐⭐⭐** |
| 商业数据源（Wind等） | 10万+ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐ |

**结论：Tushare + AKShare 是性价比最高的方案！**

---

## 📊 数据质量对比

### 龙虎榜 - Tushare 胜出

| 对比项 | Tushare | AKShare |
|--------|---------|---------|
| 数据稳定性 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| 机构席位分类 | ✅ **直接提供** | ⚠️ 需解析 |
| 历史数据完整性 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| API调用限制 | 500次/分钟 | 需要间隔 |

**推荐：Tushare**

---

### 涨停池 - AKShare 胜出

| 对比项 | Tushare | AKShare |
|--------|---------|---------|
| 字段完整性 | ⭐⭐ | ⭐⭐⭐⭐⭐ |
| 封板时间 | ❌ 无 | ✅ **有** |
| 连板数 | ❌ 无（需8000积分） | ✅ **有** |
| 炸板数据 | ❌ 无API | ✅ **专有** |
| 成本 | 500元/年 | 免费 |

**推荐：AKShare**

---

### 概念板块 - AKShare 胜出

| 对比项 | Tushare | AKShare |
|--------|---------|---------|
| 可用性 | ❌ 需6000积分 | ✅ 免费 |
| 概念数量 | ~300个 | ✅ **374个** |
| 数据来源 | Tushare自有 | 同花顺 |
| 成本 | 需升级积分 | 免费 |

**推荐：AKShare**

---

### 个股行情 - Tushare 胜出

| 对比项 | Tushare | AKShare |
|--------|---------|---------|
| 数据来源 | ⭐⭐⭐⭐⭐ 官方 | ⭐⭐⭐⭐ 爬虫 |
| 历史数据 | 2005年起 | 较全 |
| 复权因子 | ✅ 准确 | ✅ 可用 |
| 调用限制 | 500次/分钟 | 需间隔 |

**推荐：Tushare**

---

## 🔧 实施步骤

### 1. 环境配置

创建 `.env` 文件：

```env
# Tushare Pro 配置
TUSHARE_TOKEN=你的5000积分token

# Supabase 配置
SUPABASE_URL=your_supabase_url
SUPABASE_KEY=your_supabase_key

# 数据源策略
DATA_SOURCE_PRIMARY=tushare
```

### 2. 安装依赖

```bash
pip install tushare akshare supabase pandas python-dotenv
```

### 3. 使用混合采集器

```python
from data_collector_tushare_hybrid import HybridDataCollector

collector = HybridDataCollector()
results = collector.collect_all_data()
```

### 4. 数据采集流程

```
每日 16:00 自动执行:
1. Tushare: 获取龙虎榜数据（含机构席位）
2. AKShare: 获取涨停池数据（详细字段）
3. AKShare: 获取概念板块数据（374个）
4. Tushare: 获取市场统计数据（官方权威）
5. AKShare: 获取市场活跃度（独家数据）
6. 保存到 Supabase 数据库
```

---

## ✅ 最终建议总结

### 给你的建议

基于你拥有 **5000积分的Tushare账号**：

1. ✅ **强烈推荐使用** - 充分利用5000积分的优势
2. ✅ **主数据源设为 Tushare**
   - 龙虎榜（机构席位自动分类）
   - 个股行情（官方稳定）
   - 市场统计（权威数据）

3. ✅ **补充使用 AKShare**
   - 概念板块（免费且更全）
   - 涨停详情（字段更详细）
   - 市场活跃度（独家数据）
   - 炸板数据（专有API）

4. ✅ **总成本: 500元/年**
   - vs 纯商业方案：节省 99,500元/年
   - vs 纯免费方案：增加 500元/年，但数据质量提升显著

### 核心优势

```
Tushare (5000积分) 的优势:
  ✅ 龙虎榜机构席位自动分类（省去解析工作）
  ✅ 官方数据源，稳定性高
  ✅ 历史数据完整（2005年起）
  ✅ 每分钟500次调用，无日限额

AKShare (免费) 的优势:
  ✅ 涨停数据字段详细（封板时间、连板数等）
  ✅ 概念板块更全面（374个 vs 300个）
  ✅ 独家市场活跃度数据
  ✅ 炸板数据专有API
  ✅ 完全免费

两者结合 = 完美方案！
```

---

## 📚 相关文档

- [Tushare5000积分权限分析.md](./Tushare5000积分权限分析.md) - 详细权限分析
- [数据源对比分析.md](./数据源对比分析.md) - 完整数据源对比
- [data-collector-tushare-hybrid.py](./data-collector-tushare-hybrid.py) - 混合采集器代码
- [database-schema-enhanced.sql](./database-schema-enhanced.sql) - 数据库设计

---

**创建时间**: 2025-12-07
**最终方案**: ✅ **Tushare (5000积分) + AKShare (免费)**
**年度成本**: 500元
**数据覆盖率**: 100%
**推荐指数**: ⭐⭐⭐⭐⭐

**结论：这是你短线复盘项目的最佳数据源方案！** 🎉
